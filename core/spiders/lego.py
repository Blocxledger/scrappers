import json
import scrapy
from w3lib.html import remove_tags
import json

query = "query ContentPageQuery($slug: String!, $perPage: Int, $page: Int, $sort: SortInput, $filters: [Filter!], $searchSessionId: Int, $offset: Int, $giftFinderAnswers: GiftFinderAnswers) {\n  contentPage(slug: $slug) {\n    id\n    analyticsGroup\n    analyticsPageTitle\n    metaTitle\n    metaDescription\n    metaOpenGraph {\n      title\n      description\n      imageUrl\n      __typename\n    }\n    noIndexTag\n    url\n    title\n    displayTitleOnPage\n    ...Breadcrumbs\n    articleTags {\n      id\n      title\n      __typename\n    }\n    updatedAt\n    createdAt\n    jsonSchemaProperties {\n      type\n      __typename\n    }\n    contentBody {\n      ...ContentContainerData_WithProductListingSections\n      ...ContentContainerData_WithGiftFinderResultsSection\n      __typename\n    }\n    targetedContainers {\n      ...BaseTargetedContainer\n      __typename\n    }\n    __typename\n  }\n}\n\nfragment Product_ProductItem on Product {\n  __typename\n  id\n  productCode\n  programCategory {\n    name\n    key\n    __typename\n  }\n  name\n  slug\n  primaryImage(size: THUMBNAIL)\n  baseImgUrl: primaryImage\n  listingImages: listingAssets(type: IMAGE, limit: 2) {\n    ... on ListingProductAsset {\n      id\n      tag\n      url\n      thumbnailDimensions {\n        height\n        width\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  overrideUrl\n  ... on ReadOnlyProduct {\n    readOnlyVariant {\n      ...Variant_ReadOnlyProduct\n      __typename\n    }\n    __typename\n  }\n  ... on SingleVariantProduct {\n    variant {\n      ...Variant_ListingProduct\n      __typename\n    }\n    __typename\n  }\n  ... on MultiVariantProduct {\n    priceRange {\n      formattedPriceRange\n      formattedListPriceRange\n      __typename\n    }\n    variants {\n      ...Variant_ListingProduct\n      __typename\n    }\n    __typename\n  }\n}\n\nfragment Variant_ListingProduct on ProductVariant {\n  id\n  sku\n  salePercentage\n  attributes {\n    rating\n    maxOrderQuantity\n    availabilityStatus\n    availabilityText\n    vipAvailabilityStatus\n    vipAvailabilityText\n    canAddToBag\n    canAddToWishlist\n    vipCanAddToBag\n    onSale\n    isNew\n    ageRange\n    pieceCount\n    programBricksCount\n    programMinifiguresCount\n    programTagsCount\n    programHasCharger\n    programPlayType\n    safetyWarning {\n      safetyWarningKey: key\n      safetyWarningLabel: label\n      showSafetyImage\n      imageKey\n      __typename\n    }\n    programPlayType\n    ...ProductAttributes_Flags\n    __typename\n  }\n  ...ProductVariant_Pricing\n  __typename\n}\n\nfragment ProductVariant_Pricing on ProductVariant {\n  price {\n    formattedAmount\n    centAmount\n    currencyCode\n    formattedValue\n    __typename\n  }\n  insiderPrice {\n    formattedAmount\n    centAmount\n    currencyCode\n    formattedValue\n    __typename\n  }\n  insidersPoints {\n    unit\n    multiplier\n    total\n    __typename\n  }\n  priceDescription\n  listPrice {\n    formattedAmount\n    centAmount\n    __typename\n  }\n  attributes {\n    onSale\n    __typename\n  }\n  __typename\n}\n\nfragment ProductAttributes_Flags on ProductAttributes {\n  featuredFlags {\n    key\n    label\n    __typename\n  }\n  __typename\n}\n\nfragment Variant_ReadOnlyProduct on ReadOnlyVariant {\n  id\n  sku\n  attributes {\n    featuredFlags {\n      key\n      label\n      __typename\n    }\n    ageRange\n    pieceCount\n    programPlayType\n    __typename\n  }\n  __typename\n}\n\nfragment Breadcrumbs on Content {\n  breadcrumbs {\n    __typename\n    label\n    url\n    analyticsTitle\n  }\n  __typename\n}\n\nfragment ContentContainerData_WithProductListingSections on ContentContainer {\n  ...BaseContentContainer\n  section {\n    ...BaseContentSection\n    ... on ProductSection {\n      removePadding\n      filterName\n      filterValue\n      products(\n        perPage: $perPage\n        page: $page\n        sort: $sort\n        filters: $filters\n        searchSession: $searchSessionId\n        offset: $offset\n      ) {\n        ...ProductListings\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment ProductListings on ProductQueryResult {\n  resultId\n  count\n  offset\n  perPage\n  total\n  optimizelyExperiment {\n    testId\n    variantId\n    __typename\n  }\n  fetchDisruptorsOnClient\n  reservedSlots\n  results {\n    ...Product_ProductItem\n    __typename\n  }\n  facets {\n    ...Facet_FacetSidebar\n    __typename\n  }\n  sortOptions {\n    ...Sort_SortOptions\n    __typename\n  }\n  disruptors {\n    ...DisruptorStatic\n    ...DisruptorPopupVideo\n    ...DisruptorInteractive\n    __typename\n  }\n  promotion {\n    ...PromotionSectionData\n    __typename\n  }\n  __typename\n}\n\nfragment Facet_FacetSidebar on Facet {\n  name\n  key\n  id\n  isDefaultActive\n  labels {\n    __typename\n    displayMode\n    name\n    labelKey\n    count\n    ... on FacetValue {\n      __typename\n      value\n    }\n    ... on FacetRange {\n      __typename\n      from\n      to\n    }\n  }\n  __typename\n}\n\nfragment Sort_SortOptions on SortOptions {\n  id\n  key\n  direction\n  label\n  analyticLabel\n  __typename\n}\n\nfragment DisruptorStatic on DisruptorStatic {\n  __typename\n  contentType\n  title\n  background\n  colorPalette {\n    designToken\n    contrastingTextColor\n    __typename\n  }\n  isDouble\n  description\n  url\n  callToActionText\n  image {\n    url\n    width\n    height\n    maxPixelDensity\n    format\n    __typename\n  }\n  logos {\n    image {\n      url\n      width\n      height\n      maxPixelDensity\n      format\n      __typename\n    }\n    position {\n      vertical\n      horizontal\n      __typename\n    }\n    altText\n    __typename\n  }\n  videoContentModal {\n    id\n    primaryAction {\n      ctaText\n      url\n      __typename\n    }\n    secondaryAction {\n      ctaText\n      url\n      __typename\n    }\n    contentSectionTop {\n      title\n      description\n      image\n      altText\n      __typename\n    }\n    contentCardPrimary {\n      title\n      description\n      image\n      altText\n      __typename\n    }\n    contentCardSecondary {\n      title\n      description\n      image\n      altText\n      __typename\n    }\n    contentCardTertiary {\n      title\n      description\n      image\n      altText\n      __typename\n    }\n    contentSectionBottom {\n      title\n      description\n      image\n      altText\n      __typename\n    }\n    modalTitle\n    contentTitle\n    contentDescription\n    theme\n    video {\n      title\n      description\n      duration\n      thumbnail16x9\n      thumbnail1x1\n      subtitleFile\n      sprites {\n        Url\n        TilesRows\n        TilesColumns\n        SpriteWidth\n        SpriteHeight\n        __typename\n      }\n      videoFormats {\n        url\n        quality\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  testMetadata {\n    experimentKey\n    variationKey\n    __typename\n  }\n}\n\nfragment DisruptorInteractive on DisruptorInteractive {\n  __typename\n  title\n  description\n  background\n  colorPalette {\n    designToken\n    contrastingTextColor\n    __typename\n  }\n  url\n  callToActionText\n  contentType\n  videoMedia {\n    url\n    __typename\n  }\n  logos {\n    image {\n      url\n      width\n      height\n      maxPixelDensity\n      format\n      __typename\n    }\n    position {\n      vertical\n      horizontal\n      __typename\n    }\n    altText\n    __typename\n  }\n  isDouble\n  videoContentModal {\n    id\n    primaryAction {\n      ctaText\n      url\n      __typename\n    }\n    secondaryAction {\n      ctaText\n      url\n      __typename\n    }\n    contentSectionTop {\n      title\n      description\n      image\n      altText\n      __typename\n    }\n    contentCardPrimary {\n      title\n      description\n      image\n      altText\n      __typename\n    }\n    contentCardSecondary {\n      title\n      description\n      image\n      altText\n      __typename\n    }\n    contentCardTertiary {\n      title\n      description\n      image\n      altText\n      __typename\n    }\n    contentSectionBottom {\n      title\n      description\n      image\n      altText\n      __typename\n    }\n    modalTitle\n    contentTitle\n    contentDescription\n    theme\n    video {\n      title\n      description\n      duration\n      thumbnail16x9\n      thumbnail1x1\n      subtitleFile\n      sprites {\n        Url\n        TilesRows\n        TilesColumns\n        SpriteWidth\n        SpriteHeight\n        __typename\n      }\n      videoFormats {\n        url\n        quality\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  thumbnailImage {\n    url\n    width\n    height\n    maxPixelDensity\n    format\n    __typename\n  }\n  testMetadata {\n    experimentKey\n    variationKey\n    __typename\n  }\n}\n\nfragment DisruptorPopupVideo on DisruptorPopupVideo {\n  __typename\n  contentType\n  title\n  description\n  background\n  colorPalette {\n    designToken\n    contrastingTextColor\n    __typename\n  }\n  image {\n    url\n    width\n    height\n    maxPixelDensity\n    format\n    __typename\n  }\n  popupVideo {\n    subtitlesUrl\n    url\n    __typename\n  }\n  logos {\n    image {\n      url\n      width\n      height\n      maxPixelDensity\n      format\n      __typename\n    }\n    position {\n      vertical\n      horizontal\n      __typename\n    }\n    altText\n    __typename\n  }\n  testMetadata {\n    experimentKey\n    variationKey\n    __typename\n  }\n}\n\nfragment BaseContentContainer on ContentContainer {\n  id\n  multivariate {\n    experimentId\n    entityId\n    testingId\n    inExperimentAudience\n    __typename\n  }\n  targeting {\n    fetchOnClient\n    __typename\n  }\n  __typename\n}\n\nfragment BaseContentSection on ContentSection {\n  __typename\n  id\n  layout {\n    width\n    colors {\n      background\n      __typename\n    }\n    __typename\n  }\n  ...CarouselContentSection\n  ...CustomCarouselContentSection\n  ...UserGeneratedContentData\n  ...AccordionSectionData\n  ...BreadcrumbSection\n  ...CategoryListingSection\n  ...CardContent\n  ...CardCarouselContent\n  ...CopyContent\n  ...CopySectionData\n  ...QuickLinksData\n  ...ContentBlockMixedData\n  ...HeroBannerData\n  ...MotionBannerData\n  ...MotionSidekickData\n  ...InPageNavData\n  ...GalleryData\n  ...TableData\n  ...CountdownBannerData\n  ...SidekickBannerData\n  ...TextBlockData\n  ...TextBlockSEOData\n  ...CrowdTwistWidgetSection\n  ...CrowdTwistCodeRedemptionBanner\n  ...CodedSection\n  ...GridSectionData\n  ...StickyCTAData\n  ...AudioSectionData\n  ...MotionSidekick1x1Data\n  ...ImageTransitionSliderData\n  ...ImageXrayViewerData\n  ...PollsSectionData\n  ...ArtNavigationData\n  ...MotionBanner16x9Data\n  ...QuickLinksAdvancedData\n  ...ArticleSectionData\n  ...RelatedArticleSectionData\n  ...FeatureExplorerSectionData\n  ...IdeaGeneratorSectionData\n  ...TabbedContentExplorerData\n  ...CustomProductCarousel_UniqueFields\n  ...CustomProductCarousel_ItemFields\n  ...CardContentRTWData\n  ...ExpandedCardContentData\n  ...ArticleTextData\n  ...ArticleImageSectionData\n  ...ExpandedProductLeafData\n  ...ArticleGroupSectionData\n  ...MotionBannerSectionData\n  ...AdvancedProductHeroBannerSectionData\n  ...PlayTypeDetectorSectionData\n  ...SocialShareSectionData\n  ...EcosystemJourneyStarterData\n  ...ResultsBannerSectionData\n  ...CharacterExplorerSectionData\n  ...SubmissionFormBannerSectionData\n  ...MinifigureCustomiserSectionData\n  ...PromotionSectionData\n  ...StaticHeroData\n  ...TabbedStaticHeroData\n  ...VideoPlayerData\n  ...SKUCarouselData\n  ...TabbedSKUCarouselData\n  ...RewardListingSectionData\n  ...RewardCarouselData\n  ...RewardSectionData\n  ...AdvancedQuickLinksData\n  ...AutoGeneratedAdvancedQuickLinksData\n  ...SimpleQuickLinksData\n  ...TabbedAdvancedQuickLinksData\n  ...ContentCardsData\n  ...TabbedContentCardsData\n  ...BrickBreakerBannerData\n  ...ShoppableGalleryGridData\n  ...PromotionCarouselData\n  ...WelcomeBackBannerData\n  ...HighlightedProductBannerData\n  ...AutogeneratedHighlightedProductBannerData\n  ...UpsellCarouselData\n}\n\nfragment CarouselContentSection on ContentSection {\n  ... on ProductCarouselSection {\n    ...ProductCarousel_UniqueFields\n    productCarouselProducts: products(\n      page: 1\n      perPage: 16\n      sort: {key: FEATURED, direction: DESC}\n    ) {\n      ...Product_ProductItem\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment CustomCarouselContentSection on ContentSection {\n  ... on CustomProductCarouselSection {\n    ...CustomProductCarousel_UniqueFields\n    productCarouselProducts: products(\n      page: 1\n      perPage: 16\n      sort: {key: FEATURED, direction: DESC}\n    ) {\n      ...CustomProductCarousel_ItemFields\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment AccordionSectionData on AccordionSection {\n  __typename\n  id\n  title\n  showTitle\n  schema\n  layout {\n    width\n    __typename\n  }\n  accordionBlocks {\n    title\n    text\n    __typename\n  }\n}\n\nfragment BreadcrumbSection on BreadcrumbSection {\n  ...BreadcrumbDynamicSection\n  __typename\n}\n\nfragment BreadcrumbDynamicSection on BreadcrumbSection {\n  breadcrumbs {\n    label\n    url\n    analyticsTitle\n    __typename\n  }\n  __typename\n}\n\nfragment CategoryListingSection on CategoryListingSection {\n  ...CategoryListing\n  __typename\n}\n\nfragment CategoryListing on CategoryListingSection {\n  title\n  description\n  thumbnailImage\n  children {\n    ...CategoryLeafSection\n    __typename\n  }\n  hasCustomContent\n  __typename\n}\n\nfragment CategoryLeafSection on CategoryListingChildren {\n  title\n  description\n  thumbnailImage\n  logoImage\n  url\n  ageRange\n  tag\n  thumbnailSrc {\n    ...ImageAsset\n    __typename\n  }\n  doesNotHaveAnAboutPage\n  __typename\n}\n\nfragment ImageAsset on ImageAssetDetails {\n  url\n  width\n  height\n  maxPixelDensity\n  format\n  __typename\n}\n\nfragment CardContent on CardContentSection {\n  id\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  moduleTitle\n  showModuleTitle\n  backgroundColor\n  blocks {\n    title\n    isH1\n    description\n    textAlignment\n    primaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    secondaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    logoPosition\n    imageSrc {\n      ...ImageAsset\n      __typename\n    }\n    callToActionText\n    callToActionLink\n    callToActionUseAnalytics\n    callToActionOpenInNewTab\n    accountActionValue\n    accountActionReturnUrl\n    altText\n    contrast\n    videoMedia {\n      ...VideoAssetFragment\n      __typename\n    }\n    videoModalCloseButtonAriaLabel\n    __typename\n  }\n  mediaControls {\n    controlsGroup\n    play\n    pause\n    mute\n    unmute\n    volume\n    showSubtitles\n    hideSubtitles\n    enterFullscreen\n    exitFullscreen\n    skipForward\n    skipBackward\n    seeker\n    elapsedTime\n    __typename\n  }\n  previousAriaLabel\n  nextAriaLabel\n  __typename\n}\n\nfragment VideoAssetFragment on VideoMedia {\n  url\n  id\n  isLiveStream\n  subtitlesUrl\n  __typename\n}\n\nfragment CardCarouselContent on CardCarouselSection {\n  id\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  moduleTitle\n  showModuleTitle\n  backgroundColor\n  blocks {\n    title\n    isH1\n    description\n    textAlignment\n    primaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    secondaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    logoPosition\n    imageSrc {\n      ...ImageAsset\n      __typename\n    }\n    callToActionText\n    callToActionLink\n    callToActionUseAnalytics\n    callToActionOpenInNewTab\n    accountActionValue\n    accountActionReturnUrl\n    altText\n    contrast\n    videoMedia {\n      ...VideoAssetFragment\n      __typename\n    }\n    videoModalCloseButtonAriaLabel\n    __typename\n  }\n  mediaControls {\n    controlsGroup\n    play\n    pause\n    mute\n    unmute\n    volume\n    showSubtitles\n    hideSubtitles\n    enterFullscreen\n    exitFullscreen\n    skipForward\n    skipBackward\n    seeker\n    elapsedTime\n    __typename\n  }\n  previousAriaLabel\n  nextAriaLabel\n  __typename\n}\n\nfragment CopyContent on CopyContentSection {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  blocks {\n    title\n    body\n    textAlignment\n    titleColor\n    imageSrc {\n      ...ImageAsset\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment CopySectionData on CopySection {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  title\n  showTitle\n  body\n  __typename\n}\n\nfragment QuickLinksData on QuickLinkSection {\n  id\n  title\n  layout {\n    colors {\n      background\n      __typename\n    }\n    __typename\n  }\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  quickLinks {\n    title\n    isH1\n    link\n    openInNewTab\n    contrast\n    altText\n    imageSrcUrl\n    __typename\n  }\n  __typename\n}\n\nfragment ContentBlockMixedData on ContentBlockMixed {\n  id\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  moduleTitle\n  showModuleTitle\n  blocks {\n    title\n    isH1\n    description\n    backgroundColor\n    blockTheme\n    contentPosition\n    logoURL\n    secondaryLogoURL\n    logoPosition\n    callToActionText\n    callToActionLink\n    altText\n    backgroundImages {\n      largeImage {\n        small {\n          ...ImageAsset\n          __typename\n        }\n        large {\n          ...ImageAsset\n          __typename\n        }\n        __typename\n      }\n      smallImage {\n        small {\n          ...ImageAsset\n          __typename\n        }\n        large {\n          ...ImageAsset\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment UserGeneratedContentData on UserGeneratedContent {\n  id\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  ugcBlock {\n    title\n    text\n    ugcType\n    ugcKey\n    __typename\n  }\n  __typename\n}\n\nfragment HeroBannerData on HeroBanner {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  heroblocks {\n    id\n    title\n    isH1\n    tagline\n    bannerTheme\n    contentVerticalPosition\n    contentHorizontalPosition\n    contentHeight\n    primaryLogoSrcNew {\n      ...ImageAsset\n      __typename\n    }\n    secondaryLogoSrcNew {\n      ...ImageAsset\n      __typename\n    }\n    videoMedia {\n      ...VideoAssetFragment\n      __typename\n    }\n    logoPosition\n    contentBackground\n    callToActionText\n    callToActionLink\n    callToActionOpenInNewTab\n    brandedAppStoreAsset {\n      ...ImageAsset\n      __typename\n    }\n    callToActionAccountAction\n    callToActionReturnUrl\n    callToActionUseAnalytics\n    secondaryCallToActionText\n    secondaryCallToActionLink\n    secondaryCallToActionAccountAction\n    secondaryCallToActionReturnUrl\n    secondaryBrandedAppStoreAsset {\n      ...ImageAsset\n      __typename\n    }\n    secondaryCallToActionUseAnalytics\n    secondaryOpenInNewTab\n    backgroundImagesNew {\n      small {\n        ...ImageAsset\n        __typename\n      }\n      medium {\n        ...ImageAsset\n        __typename\n      }\n      large {\n        ...ImageAsset\n        __typename\n      }\n      __typename\n    }\n    altText\n    showEmailSignupForm\n    __typename\n  }\n  __typename\n}\n\nfragment GalleryData on Gallery {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  galleryblocks {\n    id\n    contentHeight\n    primaryLogoSrcNew {\n      ...ImageAsset\n      __typename\n    }\n    videoMedia {\n      ...VideoAssetFragment\n      __typename\n    }\n    backgroundImagesNew {\n      small {\n        ...ImageAsset\n        __typename\n      }\n      medium {\n        ...ImageAsset\n        __typename\n      }\n      large {\n        ...ImageAsset\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment MotionBannerData on MotionBanner {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  motionBannerBlocks {\n    id\n    title\n    isH1\n    tagline\n    bannerTheme\n    contentHorizontalPosition\n    primaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    secondaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    animatedMedia\n    videoMedia {\n      ...VideoAssetFragment\n      __typename\n    }\n    logoPosition\n    contentBackground\n    callToActionText\n    callToActionLink\n    callToActionUseAnalytics\n    secondaryCallToActionText\n    secondaryCallToActionLink\n    secondaryCallToActionUseAnalytics\n    backgroundImages {\n      small {\n        ...ImageAsset\n        __typename\n      }\n      medium {\n        ...ImageAsset\n        __typename\n      }\n      large {\n        ...ImageAsset\n        __typename\n      }\n      __typename\n    }\n    altText\n    __typename\n  }\n  __typename\n}\n\nfragment MotionSidekickData on MotionSidekick {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  motionSidekickBlocks {\n    id\n    title\n    isH1\n    tagline\n    bannerTheme\n    contentHorizontalPosition\n    primaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    secondaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    animatedMedia\n    videoMedia {\n      ...VideoAssetFragment\n      __typename\n    }\n    logoPosition\n    contentBackground\n    callToActionText\n    callToActionLink\n    callToActionUseAnalytics\n    backgroundImages {\n      small {\n        ...ImageAsset\n        __typename\n      }\n      medium {\n        ...ImageAsset\n        __typename\n      }\n      large {\n        ...ImageAsset\n        __typename\n      }\n      __typename\n    }\n    altText\n    __typename\n  }\n  __typename\n}\n\nfragment InPageNavData on InPageNav {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  inPageNavBlocks {\n    id\n    title\n    isH1\n    text\n    contrast\n    primaryLogoSrc\n    secondaryLogoSrc\n    animatedMedia\n    videoMedia {\n      url\n      id\n      subtitlesUrl\n      __typename\n    }\n    contentBackground\n    backgroundImages {\n      small\n      medium\n      large\n      __typename\n    }\n    callToActionText\n    callToActionLink\n    callToActionUseAnalytics\n    openInNewTab\n    secondaryCallToActionText\n    secondaryCallToActionLink\n    secondaryCallToActionUseAnalytics\n    secondaryOpenInNewTab\n    __typename\n  }\n  __typename\n}\n\nfragment TableData on TableSection {\n  rows {\n    isHeadingRow\n    cells\n    __typename\n  }\n  __typename\n}\n\nfragment SidekickBannerData on SidekickBanner {\n  __typename\n  id\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  sidekickBlocks {\n    title\n    isH1\n    text\n    textAlignment\n    contrast\n    backgroundColor\n    logoSrc {\n      ...ImageAsset\n      __typename\n    }\n    secondaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    logoPosition\n    ctaTextPrimary: ctaText\n    ctaLinkPrimary: ctaLink\n    ctaOpenInNewTab\n    ctaUseAnalyticsPrimary: ctaUseAnalytics\n    brandedAppStoreAsset {\n      ...ImageAsset\n      __typename\n    }\n    ctaTextSecondary\n    ctaLinkSecondary\n    ctaOpenInNewTabSecondary\n    ctaUseAnalyticsSecondary\n    secondaryBrandedAppStoreAsset {\n      ...ImageAsset\n      __typename\n    }\n    contentHeight\n    bgImages {\n      large\n      __typename\n    }\n    videoMedia {\n      ...VideoAssetFragment\n      __typename\n    }\n    altText\n    __typename\n  }\n}\n\nfragment ProductCarousel_UniqueFields on ProductCarouselSection {\n  __typename\n  productCarouselTitle: title\n  showTitle\n  showAddToBag\n  seeAllLink\n  seeAllLinkText\n  nextAriaLabel\n  previousAriaLabel\n}\n\nfragment TextBlockData on TextBlock {\n  id\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  textBlocks {\n    title\n    isH1\n    text\n    textAlignment\n    contrast\n    backgroundColor\n    callToActionLink\n    callToActionText\n    callToActionUseAnalytics\n    openInNewTab\n    secondaryCallToActionLink\n    secondaryCallToActionText\n    secondaryCallToActionUseAnalytics\n    secondaryOpenInNewTab\n    __typename\n  }\n  __typename\n}\n\nfragment TextBlockSEOData on TextBlockSEO {\n  id\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  textBlocks {\n    title\n    text\n    actionLabels {\n      readMore\n      showLess\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment CrowdTwistWidgetSection on CrowdTwistWidgetSection {\n  __typename\n  id\n  heading\n  activityId\n  rewardId\n  defaultOpen\n}\n\nfragment CrowdTwistCodeRedemptionBanner on CrowdTwistCodeRedemptionBanner {\n  __typename\n  heading\n  description\n  buttonText\n  inputLabel\n  campaignId\n  groupCampaignId\n  imageUrl\n}\n\nfragment CodedSection on CodedSection {\n  __typename\n  id\n  componentName\n  properties {\n    key\n    value\n    __typename\n  }\n  text {\n    key\n    value\n    __typename\n  }\n  media {\n    key\n    values {\n      id\n      contentType\n      fileSize\n      filename\n      url\n      title\n      __typename\n    }\n    __typename\n  }\n}\n\nfragment GridSectionData on GridSection {\n  layout {\n    colors {\n      background\n      __typename\n    }\n    __typename\n  }\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  items {\n    id\n    image\n    videoMedia {\n      ...VideoAssetFragment\n      __typename\n    }\n    href\n    text\n    textContrast\n    __typename\n  }\n  __typename\n}\n\nfragment AudioSectionData on AudioSection {\n  tracks {\n    trackArt {\n      ...ImageAsset\n      __typename\n    }\n    src\n    title\n    description\n    __typename\n  }\n  backgroundColor\n  textContrast\n  backgroundImage {\n    mobile {\n      ...ImageAsset\n      __typename\n    }\n    desktop {\n      ...ImageAsset\n      __typename\n    }\n    __typename\n  }\n  seriesTitle\n  seriesThumbnail {\n    ...ImageAsset\n    __typename\n  }\n  __typename\n}\n\nfragment StickyCTAData on StickyCTASection {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  item {\n    backgroundColor\n    ctaBackgroundImage\n    ctaPosition\n    href\n    openInNewTab\n    accountAction\n    returnUrl\n    text\n    textAlign\n    textContrast\n    effect\n    delay\n    __typename\n  }\n  __typename\n}\n\nfragment MotionSidekick1x1Data on MotionSidekick1x1 {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  motionSidekickBlocks {\n    id\n    title\n    description\n    textContrast\n    contentHorizontalPosition\n    primaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    secondaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    inlineVideo {\n      ...VideoAssetFragment\n      __typename\n    }\n    fullVideo {\n      ...VideoAssetFragment\n      __typename\n    }\n    logoHorizontalPosition\n    backgroundColor\n    primaryCallToActionText\n    primaryCallToActionLink\n    primaryCallToActionUseAnalytics\n    secondaryCallToActionText\n    secondaryCallToActionLink\n    secondaryCallToActionUseAnalytics\n    __typename\n  }\n  __typename\n}\n\nfragment ImageTransitionSliderData on ImageTransitionSlider {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  imageTransitionSliderBlocks {\n    id\n    title\n    description\n    backgroundColor\n    contrast\n    ctas {\n      link\n      text\n      useAnalytics\n      __typename\n    }\n    contentHorizontalPosition\n    firstImage {\n      ...ImageAsset\n      __typename\n    }\n    firstImageFullWidth {\n      ...ImageAsset\n      __typename\n    }\n    secondImage {\n      ...ImageAsset\n      __typename\n    }\n    secondImageFullWidth {\n      ...ImageAsset\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment ImageXrayViewerData on ImageXrayViewer {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  imageXrayViewerBlocks {\n    id\n    title\n    description\n    backgroundColor\n    contrast\n    ctas {\n      link\n      text\n      useAnalytics\n      __typename\n    }\n    contentHorizontalPosition\n    firstImage {\n      ...ImageAsset\n      __typename\n    }\n    secondImage {\n      ...ImageAsset\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment PollsSectionData on PollsSection {\n  id\n  question\n  backgroundColor\n  answerFillColor\n  answerBorderColor\n  answers {\n    answer\n    id\n    __typename\n  }\n  image {\n    ...ImageAsset\n    __typename\n  }\n  imageAlignment\n  pollResults {\n    answers {\n      answerId\n      count\n      __typename\n    }\n    totalVotes\n    __typename\n  }\n  showPollResults\n  submissionConfirmationTitle\n  submissionConfirmationContent\n  __typename\n}\n\nfragment ArtNavigationData on ArtNavigation {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  artNavigationBlocks {\n    id\n    title\n    cardTitle\n    darkMode\n    callToActionLink\n    backgroundImage {\n      ...ImageAsset\n      __typename\n    }\n    logoImage {\n      ...ImageAsset\n      __typename\n    }\n    textImage {\n      ...ImageAsset\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment MotionBanner16x9Data on MotionBanner16x9 {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  motionBannerBlocks {\n    id\n    title\n    isH1\n    tagline\n    contentHorizontalPosition\n    primaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    secondaryLogoSrc {\n      ...ImageAsset\n      __typename\n    }\n    animatedMedia\n    videoMedia {\n      ...VideoAssetFragment\n      __typename\n    }\n    logoPosition\n    contentBackground\n    callToActionText\n    callToActionLink\n    callToActionUseAnalytics\n    secondaryCallToActionText\n    secondaryCallToActionLink\n    secondaryCallToActionUseAnalytics\n    altText\n    __typename\n  }\n  __typename\n}\n\nfragment QuickLinksAdvancedData on QuickLinkAdvancedSection {\n  id\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  backgroundColor\n  items {\n    title\n    link\n    openInNewTab\n    contrast\n    imageSrc {\n      small {\n        ...ImageAsset\n        __typename\n      }\n      medium {\n        ...ImageAsset\n        __typename\n      }\n      __typename\n    }\n    textAlignment\n    textAlignmentVertical\n    __typename\n  }\n  __typename\n}\n\nfragment ArticleSectionData on ArticleSection {\n  id\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  articleBlocks {\n    id\n    contentTitle\n    setAsH1\n    richText\n    width\n    product {\n      ...Product_ProductItem\n      __typename\n    }\n    productAlignment\n    backgroundColor\n    contentAlignment\n    callToActionText\n    callToActionType\n    callToActionLink\n    callToActionUseAnalytics\n    openInNewTab\n    image {\n      ...ImageAsset\n      __typename\n    }\n    caption\n    captionDarkMode\n    __typename\n  }\n  __typename\n}\n\nfragment RelatedArticleSectionData on RelatedArticleSection {\n  id\n  title\n  articles {\n    id\n    title\n    description\n    url\n    image {\n      ...ImageAsset\n      __typename\n    }\n    __typename\n  }\n  backgroundColor\n  showCta\n  target {\n    text\n    href\n    __typename\n  }\n  previousAriaLabel\n  nextAriaLabel\n  __typename\n}\n\nfragment FeatureExplorerSectionData on FeatureExplorerSection {\n  id\n  title\n  showHeader\n  backgroundGradientColors {\n    backgroundLightColor\n    backgroundDarkColor\n    __typename\n  }\n  overlayBackgroundColor\n  overlayTextColor\n  accentColor\n  logo {\n    logoLibraryLogo {\n      logoName\n      altText\n      __typename\n    }\n    image\n    altText\n    __typename\n  }\n  secondaryLogo {\n    logoLibraryLogo {\n      logoName\n      altText\n      __typename\n    }\n    image\n    altText\n    __typename\n  }\n  hasAudio\n  features {\n    title\n    text\n    scene\n    position {\n      x\n      y\n      isGridCoordinates\n      __typename\n    }\n    video\n    image\n    altText\n    subtitles\n    subtitlesLang\n    featureHasAudio\n    __typename\n  }\n  frames\n  dragControlBar {\n    position\n    theme\n    __typename\n  }\n  mediaControls {\n    mute\n    unmute\n    showSubtitles\n    hideSubtitles\n    __typename\n  }\n  __typename\n}\n\nfragment IdeaGeneratorSectionData on IdeaGeneratorSection {\n  id\n  title\n  previewContent {\n    title\n    text\n    callToActionText\n    __typename\n  }\n  mainContent {\n    startText\n    retryText\n    ideaLimit\n    unlockThreshold\n    endText\n    callToAction {\n      text\n      link\n      openInNewWindow\n      __typename\n    }\n    __typename\n  }\n  problems {\n    text\n    image\n    altText\n    tags\n    __typename\n  }\n  multipliers {\n    text\n    image\n    altText\n    tags\n    __typename\n  }\n  validProblems {\n    text\n    image\n    altText\n    tags\n    __typename\n  }\n  __typename\n}\n\nfragment TabbedContentExplorerData on TabbedContentExplorerSection {\n  __typename\n  id\n  layout {\n    width\n    colors {\n      background\n      __typename\n    }\n    __typename\n  }\n  blocks {\n    title\n    backgroundColor\n    accentColor\n    target {\n      href\n      text\n      openInNewTab\n      __typename\n    }\n    images {\n      alt\n      desktop {\n        ...ImageAsset\n        __typename\n      }\n      mobile {\n        ...ImageAsset\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n}\n\nfragment CustomProductCarousel_UniqueFields on CustomProductCarouselSection {\n  __typename\n  productCarouselTitle: title\n  showTitle\n  showAddToBag\n  seeAllLink\n  seeAllLinkText\n  backgroundColor\n  nextAriaLabel\n  previousAriaLabel\n}\n\nfragment CustomProductCarousel_ItemFields on CustomProductCarouselItem {\n  product {\n    ...Product_ProductItem\n    __typename\n  }\n  imageOverride {\n    ...ImageAsset\n    __typename\n  }\n  imageBackgroundColor\n  contentBackgroundColor\n  ctaButtonColor\n  __typename\n}\n\nfragment Countdown on CountdownBannerChild {\n  title\n  isH1\n  text\n  contrast\n  backgroundColor\n  callToActionLink\n  callToActionText\n  openInNewTab\n  countdownDate\n  countdownDateFormat\n  __typename\n}\n\nfragment CountdownBannerData on CountdownBanner {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  countdownBannerBlocks {\n    ...Countdown\n    __typename\n  }\n  __typename\n}\n\nfragment CardContentRTWData on CardContentRTWSection {\n  layoutLegacy {\n    fullWidth\n    removePadding\n    __typename\n  }\n  moduleTitle\n  showModuleTitle\n  backgroundColor\n  preferCarousel\n  hasShadow\n  blocks {\n    title\n    description\n    backgroundColor\n    textAlignment\n    imageSrc {\n      ...ImageAsset\n      __typename\n    }\n    altText\n    videoMedia {\n      ...VideoAssetFragment\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment ExpandedCardContentData on ExpandedCardContentSection {\n  isStaggered\n  darkMode\n  contentOpacity\n  contentBackgroundColor\n  blocks {\n    id\n    title\n    text\n    darkMode\n    contentAlignment\n    desktopBackgroundImage {\n      ...ImageAsset\n      __typename\n    }\n    mobileBackgroundImage {\n      ...ImageAsset\n      __typename\n    }\n    target {\n      href\n      text\n      openInNewTab\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment ArticleTextData on ArticleTextSection {\n  id\n  title\n  richText\n  textAlignment\n  __typename\n}\n\nfragment ArticleImageSectionData on ArticleImageSection {\n  title\n  image {\n    ...ImageAsset\n    __typename\n  }\n  altText\n  caption\n  captionBackground\n  __typename\n}\n\nfragment ExpandedProductLeafData on ExpandedProductLeafSection {\n  id\n  productCode\n  __typename\n}\n\nfragment ArticleGroupSectionData on ArticleGroupSection {\n  id\n  articleGroupBlocks {\n    ... on ArticleGroupImageBlock {\n      id\n      __typename\n      layout {\n        width\n        colors {\n          background\n          __typename\n        }\n        __typename\n      }\n      image {\n        ...ImageAsset\n        __typename\n      }\n      altText\n      caption\n      captionBackground\n    }\n    ... on ArticleGroupTextBlock {\n      id\n      __typename\n      layout {\n        width\n        colors {\n          background\n          __typename\n        }\n        __typename\n      }\n      textAlignment\n      richText\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment MotionBannerSectionData on MotionBannerSection {\n  id\n  title\n  isH1\n  tagline\n  bannerTheme\n  contentHorizontalPosition\n  contentVerticalPosition\n  aspectRatio\n  backgroundVideoMobile\n  backgroundVideoTablet\n  backgroundVideoDesktop\n  modalVideo {\n    ...VideoAssetFragment\n    __typename\n  }\n  backgroundImages {\n    small {\n      ...ImageAsset\n      __typename\n    }\n    medium {\n      ...ImageAsset\n      __typename\n    }\n    large {\n      ...ImageAsset\n      __typename\n    }\n    __typename\n  }\n  altText\n  primaryLogoSrc {\n    ...ImageAsset\n    __typename\n  }\n  secondaryLogoSrc {\n    ...ImageAsset\n    __typename\n  }\n  primaryCallToAction {\n    href\n    text\n    openInNewTab\n    accountAction\n    returnUrl\n    useAnalytics\n    __typename\n  }\n  secondaryCallToAction {\n    href\n    text\n    openInNewTab\n    accountAction\n    returnUrl\n    useAnalytics\n    __typename\n  }\n  logoPosition\n  __typename\n}\n\nfragment ColorPaletteColor on ColorPaletteColor {\n  designToken\n  contrastingTextColor\n  __typename\n}\n\nfragment AdvancedProductHeroBannerSectionData on AdvancedProductHeroBannerSection {\n  id\n  title\n  productCode\n  productDescriptionText\n  isAtTopOfPage\n  infoTagText\n  target {\n    href\n    text\n    __typename\n  }\n  targetKey\n  colorPalette {\n    primary {\n      ...ColorPaletteColor\n      __typename\n    }\n    secondary {\n      ...ColorPaletteColor\n      __typename\n    }\n    tertiary {\n      ...ColorPaletteColor\n      __typename\n    }\n    quaternary {\n      ...ColorPaletteColor\n      __typename\n    }\n    __typename\n  }\n  productImage {\n    desktop\n    mobile\n    alt\n    __typename\n  }\n  infoPanel {\n    text\n    alt\n    logo\n    secondaryAlt\n    secondarylogo\n    __typename\n  }\n  localizations\n  useLegacyDesign\n  displayAddToBag\n  titleSize\n  textColor\n  minifigures {\n    minifigureCount\n    minifigureImages {\n      altText\n      image\n      __typename\n    }\n    __typename\n  }\n  secondaryTarget {\n    href\n    text\n    __typename\n  }\n  secondaryTargetKey\n  primaryLogo {\n    logoName\n    altText\n    __typename\n  }\n  secondaryLogo {\n    logoName\n    altText\n    __typename\n  }\n  tags {\n    tag\n    terms\n    __typename\n  }\n  product {\n    name\n    slug\n    productCode\n    primaryImage\n    ... on SingleVariantProduct {\n      __typename\n      variant {\n        sku\n        vipPoints\n        salePercentage\n        attributes {\n          ...ProductHeroVariantAttributes\n          __typename\n        }\n        price {\n          ...ProductHeroPriceAttributes\n          __typename\n        }\n        listPrice {\n          ...ProductHeroPriceAttributes\n          __typename\n        }\n        insiderPrice {\n          formattedAmount\n          __typename\n        }\n        priceDescription\n        __typename\n      }\n    }\n    ... on ReadOnlyProduct {\n      __typename\n      readOnlyVariant {\n        sku\n        attributes {\n          ...ProductHeroVariantAttributes\n          __typename\n        }\n        __typename\n      }\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment ProductHeroVariantAttributes on ProductAttributes {\n  ageRange\n  availabilityStatus\n  availabilityText\n  canAddToBag\n  canAddToWishlist\n  featuredFlags {\n    key\n    label\n    __typename\n  }\n  isNew\n  isHardToFind\n  isExclusive\n  onSale\n  pieceCount\n  rating\n  vipAvailabilityStatus\n  vipAvailabilityText\n  vipCanAddToBag\n  maxOrderQuantity\n  __typename\n}\n\nfragment ProductHeroPriceAttributes on Price {\n  formattedAmount\n  formattedValue\n  currencyCode\n  centAmount\n  __typename\n}\n\nfragment StaticHeroData on StaticHero {\n  height\n  title\n  staticHeroAnalyticsTitle: analyticsTitle\n  isH1\n  lazyLoadMedia\n  displayLargeTitle\n  tabTitle\n  bodyText\n  contentPositioning\n  mobileContentPositioning\n  colorPalette {\n    primary {\n      contrastingTextColor\n      designToken\n      __typename\n    }\n    __typename\n  }\n  titleTextColor\n  buttonAppearance\n  backgroundImageDesktop\n  backgroundImageMobile\n  backgroundImageTablet\n  backgroundAltText\n  displayVideo\n  video {\n    url\n    subtitlesUrl\n    __typename\n  }\n  backgroundVideo {\n    mobile\n    tablet\n    desktop\n    autoPlay\n    __typename\n  }\n  modalVideoButton\n  videoAriaLabels {\n    videoPlayAriaLabel\n    videoModalCloseButtonAriaLabel\n    __typename\n  }\n  primaryLogo {\n    logoName\n    logoAltText\n    __typename\n  }\n  secondaryLogo {\n    logoName\n    logoAltText\n    __typename\n  }\n  tertiaryLogo {\n    logoName\n    logoAltText\n    __typename\n  }\n  tags {\n    tag\n    terms\n    __typename\n  }\n  logoPositioning\n  primaryProductBadge\n  primaryProductBadgeAppearance\n  secondaryProductBadge\n  secondaryProductBadgeAppearance\n  productSKU\n  primaryButtonCallToActionLink\n  primaryButtonOpenInNewTab\n  primaryButtonAccountAction\n  primaryButtonReturnUrl\n  secondaryButtonName\n  secondaryButtonCtaKey\n  secondaryButtonCallToActionLink\n  secondaryButtonOpenInNewTab\n  secondaryButtonAccountAction\n  secondaryButtonReturnUrl\n  primaryButtonName\n  primaryButtonCtaKey\n  id\n  moduleName\n  layout {\n    width\n    colors {\n      background\n      __typename\n    }\n    __typename\n  }\n  personalisationMetadata {\n    modelId\n    modelName\n    personalisationId\n    __typename\n  }\n  hotSpotLabels {\n    addToCartButtonLabel\n    closedHotSpotLabel\n    hotSpotLinkLabel\n    openedHotSpotLabel\n    __typename\n  }\n  hotSpots {\n    product {\n      id\n      name\n      productCode\n      slug\n      ... on SingleVariantProduct {\n        primaryImage\n        variant {\n          id\n          sku\n          attributes {\n            ...CommonAttributes\n            __typename\n          }\n          price {\n            ...CommonPriceAttributes\n            __typename\n          }\n          __typename\n        }\n        __typename\n      }\n      ... on MultiVariantProduct {\n        variants {\n          id\n          sku\n          attributes {\n            ...CommonAttributes\n            __typename\n          }\n          price {\n            ...CommonPriceAttributes\n            __typename\n          }\n          __typename\n        }\n        __typename\n      }\n      ... on ReadOnlyProduct {\n        readOnlyVariant {\n          id\n          sku\n          attributes {\n            ...CommonAttributes\n            __typename\n          }\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    analyticsTitle\n    coordinates {\n      xs {\n        ...Coordinates\n        __typename\n      }\n      sm {\n        ...Coordinates\n        __typename\n      }\n      md {\n        ...Coordinates\n        __typename\n      }\n      lg {\n        ...Coordinates\n        __typename\n      }\n      xl {\n        ...Coordinates\n        __typename\n      }\n      default {\n        ...Coordinates\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  removeHero\n  mediaControls {\n    controlsGroup\n    play\n    pause\n    mute\n    unmute\n    volume\n    showSubtitles\n    hideSubtitles\n    enterFullscreen\n    exitFullscreen\n    skipForward\n    skipBackward\n    seeker\n    elapsedTime\n    __typename\n  }\n  __typename\n}\n\nfragment CommonAttributes on ProductAttributes {\n  ageRange\n  availabilityStatus\n  canAddToBag\n  canAddToWishlist\n  pieceCount\n  isNew\n  onSale\n  rating\n  __typename\n}\n\nfragment CommonPriceAttributes on Price {\n  formattedAmount\n  formattedValue\n  currencyCode\n  centAmount\n  __typename\n}\n\nfragment Coordinates on GridCoordinate {\n  row\n  column\n  __typename\n}\n\nfragment TabbedStaticHeroData on TabbedContent {\n  id\n  accessibleTitle\n  analyticsTitle\n  tabbedContentBackgroundColor: backgroundColor\n  colorMode\n  contentType\n  tabs {\n    __typename\n    ...StaticHeroData\n  }\n  __typename\n}\n\nfragment PlayTypeDetectorSectionData on PlayTypeDetectorSection {\n  id\n  colors {\n    answer1\n    answer2\n    cardTheme\n    cta\n    __typename\n  }\n  startStep {\n    heading\n    text\n    ctaText\n    background {\n      desktopImage\n      desktopTheme\n      mobileImage\n      mobileTheme\n      __typename\n    }\n    __typename\n  }\n  questionsStep {\n    background {\n      desktopImage\n      desktopTheme\n      mobileImage\n      mobileTheme\n      __typename\n    }\n    slider {\n      helpText\n      draggerImage\n      answer1TargetImage\n      answer1ConfirmationImage\n      answer2TargetImage\n      answer2ConfirmationImage\n      __typename\n    }\n    questions {\n      id\n      text\n      answers {\n        text\n        image\n        targetPage\n        targetQuestion\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  referralStep {\n    image\n    heading\n    text\n    __typename\n  }\n  __typename\n}\n\nfragment SocialShareSectionData on SocialShareSection {\n  id\n  title\n  sharingTitle\n  sharingBodyText\n  socialSharePlatforms\n  hashtags\n  displaySocialIcons\n  layout {\n    width\n    __typename\n  }\n  __typename\n}\n\nfragment EcosystemJourneyStarterData on EcosystemJourneyStarterSection {\n  id\n  title\n  isH1\n  icmp_tag\n  themes {\n    colors {\n      background\n      contentTitle\n      contentBackground\n      contentBodyMobile\n      contentBodyDesktop\n      navigationHighlight\n      accentLeft\n      accentRight\n      cta\n      ctaText\n      navigation\n      navigationTextColor\n      __typename\n    }\n    navigation {\n      name\n      logo\n      thumbnail\n      logoLibraryLogo {\n        logoName\n        altText\n        __typename\n      }\n      __typename\n    }\n    content {\n      image\n      altText\n      title\n      body\n      ageSuitability\n      primaryCTALabel\n      primaryCTALink\n      primaryCTAOpenInNewWindow\n      secondaryCTALabel\n      secondaryCTALink\n      secondaryCTAOpenInNewWindow\n      __typename\n    }\n    productCarousel {\n      label\n      productData {\n        data {\n          ... on SingleVariantProduct {\n            variant {\n              attributes {\n                availabilityStatus\n                __typename\n              }\n              price {\n                formattedAmount\n                __typename\n              }\n              __typename\n            }\n            name\n            primaryImage\n            slug\n            pdpPath\n            productCode\n            __typename\n          }\n          ... on ReadOnlyProduct {\n            readOnlyVariant {\n              attributes {\n                availabilityStatus\n                __typename\n              }\n              __typename\n            }\n            name\n            primaryImage\n            slug\n            pdpPath\n            productCode\n            __typename\n          }\n          ... on MultiVariantProduct {\n            name\n            primaryImage\n            slug\n            pdpPath\n            productCode\n            __typename\n          }\n          __typename\n        }\n        imageOverride\n        __typename\n      }\n      __typename\n    }\n    tags {\n      tag\n      terms\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment ResultsBannerSectionData on ResultsBannerSection {\n  id\n  title\n  resultsBannerBackgroundColor: backgroundColor\n  fontColor\n  mobileImageLeft\n  desktopImageLeft\n  desktopImageRight\n  desktopButtonText\n  noResults {\n    noResultsText\n    ctaText\n    secondaryCta {\n      text\n      url\n      __typename\n    }\n    easterEgg {\n      heading\n      subHeading\n      easterEggImage\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment CharacterExplorerSectionData on CharacterExplorerSection {\n  id\n  title\n  backButtonLabel\n  productSubtitle\n  removeIntroScreenCtas\n  characters {\n    intro {\n      image\n      tagline\n      characterCTALabel\n      title\n      __typename\n    }\n    colors {\n      character\n      characterLabel\n      bio\n      bioLabel\n      background\n      textHighlight\n      highlightLabelDesktop\n      highlightLabelMobile\n      productBackground\n      productLabel\n      __typename\n    }\n    characterProduct {\n      title\n      overrideImage\n      code\n      __typename\n    }\n    content {\n      body\n      displayCharacterName\n      header\n      bioImage\n      mobileNavigationLabels\n      passions {\n        icon\n        value\n        __typename\n      }\n      __typename\n    }\n    nonShoppableContent {\n      image\n      text\n      mobileNavigationLabelRight\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment SubmissionFormBannerSectionData on SubmissionFormBannerSection {\n  id\n  title\n  layout {\n    width\n    colors {\n      background\n      __typename\n    }\n    __typename\n  }\n  bannerContent {\n    title\n    body\n    backgroundImageSmall\n    backgroundImageMedium\n    backgroundImageLarge\n    backgroundColorMobile\n    fontColor\n    video\n    primaryCTALabel\n    secondaryCTALabel\n    __typename\n  }\n  modalContent {\n    formId\n    closeLabel\n    title\n    description\n    fields {\n      fieldId\n      type\n      label\n      placeholderText\n      errorText\n      options {\n        value\n        label\n        __typename\n      }\n      __typename\n    }\n    fileUploadParams {\n      maxSizeInMb\n      allowedFileExtensions\n      __typename\n    }\n    termsAndConditionsLabel\n    termsAndConditions\n    termsAndConditionsFile\n    termsAndConditionsDownloadLabel\n    consentLabel\n    additionalConsentLabel\n    submitButtonLabel\n    __typename\n  }\n  successMessageContent {\n    title\n    body\n    additionalContent\n    ctaLabel\n    ctaIcon\n    ctaLink\n    __typename\n  }\n  translations {\n    key\n    value\n    __typename\n  }\n  __typename\n}\n\nfragment MinifigureCustomiserSectionData on MinifigureCustomiserSection {\n  id\n  layout {\n    width\n    colors {\n      background\n      __typename\n    }\n    removePadding\n    backgroundColor\n    __typename\n  }\n  content {\n    common {\n      backButtonText\n      backgroundColor\n      minifigImageAltText\n      flareImage\n      __typename\n    }\n    bannerStep {\n      title\n      body\n      ctaText\n      foregroundImageMobile\n      foregroundImageDesktop\n      __typename\n    }\n    customiseStep {\n      closeButtonText\n      finishButtonText\n      traySections {\n        head {\n          label\n          active\n          inactive\n          options\n          __typename\n        }\n        hair {\n          label\n          active\n          inactive\n          options\n          __typename\n        }\n        beard {\n          label\n          active\n          inactive\n          options\n          __typename\n        }\n        torso {\n          label\n          active\n          inactive\n          options\n          __typename\n        }\n        legs {\n          label\n          active\n          inactive\n          options\n          __typename\n        }\n        crutches {\n          label\n          active\n          inactive\n          options\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    confirmStep {\n      flipButtonText\n      rearCardTitle\n      rearCardBody\n      rearCardCTAText\n      rearCardCTALink\n      downloadCTAText\n      shareCTAText\n      restartCTAText\n      hashtagText\n      rearCardImage\n      frontCardImage\n      __typename\n    }\n    minifigLayers {\n      hair {\n        color\n        colorLabel\n        images\n        __typename\n      }\n      beard {\n        color\n        colorLabel\n        images\n        __typename\n      }\n      head {\n        color\n        colorLabel\n        image\n        __typename\n      }\n      torso\n      legs\n      face\n      crutches\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment PromotionSectionData on PromotionSection {\n  id\n  isExpanded\n  backgroundColorPalette: backgroundColor {\n    ...ColorPaletteColor\n    __typename\n  }\n  accentTextColorPalette: accentTextColor {\n    ...ColorPaletteColor\n    __typename\n  }\n  __typename\n}\n\nfragment VideoPlayerData on VideoPlayerSection {\n  id\n  title\n  isH1\n  videoPlayerBackgroundColor: backgroundColor\n  contrastColor\n  colorMode\n  playlists {\n    title\n    videoCount\n    videos {\n      title\n      description\n      duration\n      videoFormats {\n        quality\n        url\n        __typename\n      }\n      thumbnail16x9\n      thumbnail1x1\n      subtitleFile\n      sprites {\n        Url\n        TilesRows\n        TilesColumns\n        SpriteHeight\n        SpriteWidth\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  mediaControls {\n    controlsGroup\n    play\n    pause\n    mute\n    unmute\n    volume\n    showSubtitles\n    hideSubtitles\n    enterFullscreen\n    exitFullscreen\n    skipForward\n    skipBackward\n    seeker\n    elapsedTime\n    __typename\n  }\n  jsonSchema\n  __typename\n}\n\nfragment SKUCarouselData on SKUCarousel {\n  id\n  title\n  displayTitle\n  analyticsTitle\n  cta {\n    link\n    label\n    __typename\n  }\n  textColor\n  leafBackgroundColor\n  leafTextColor\n  leafFrame\n  SKUCarouselBackgroundColor: backgroundColor\n  algorithm\n  productSource\n  personalisationMetadata {\n    modelId\n    modelName\n    personalisationId\n    __typename\n  }\n  tags {\n    tag\n    terms\n    __typename\n  }\n  nextAriaLabel\n  previousAriaLabel\n  SKUCarouselProducts: products {\n    imageOverride\n    data {\n      productCode\n      primaryImage\n      listingAssets(type: IMAGE, limit: 1) {\n        id\n        url\n        tag\n        __typename\n      }\n      id\n      slug\n      name\n      secondaryImage\n      overrideUrl\n      programCategory {\n        name\n        key\n        __typename\n      }\n      ... on SingleVariantProduct {\n        __typename\n        variant {\n          id\n          sku\n          salePercentage\n          attributes {\n            ...SKUVariantAttributes\n            __typename\n          }\n          price {\n            ...SKUPriceAttributes\n            __typename\n          }\n          listPrice {\n            ...SKUPriceAttributes\n            __typename\n          }\n          insiderPrice {\n            formattedAmount\n            __typename\n          }\n          insidersPoints {\n            unit\n            multiplier\n            total\n            __typename\n          }\n          priceDescription\n          __typename\n        }\n      }\n      ... on MultiVariantProduct {\n        __typename\n        variants {\n          id\n          sku\n          salePercentage\n          attributes {\n            ...SKUVariantAttributes\n            __typename\n          }\n          price {\n            ...SKUPriceAttributes\n            __typename\n          }\n          insidersPoints {\n            unit\n            multiplier\n            total\n            __typename\n          }\n          listPrice {\n            ...SKUPriceAttributes\n            __typename\n          }\n          __typename\n        }\n      }\n      ... on ReadOnlyProduct {\n        __typename\n        readOnlyVariant {\n          id\n          sku\n          attributes {\n            ...SKUVariantAttributes\n            __typename\n          }\n          __typename\n        }\n      }\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment SKUVariantAttributes on ProductAttributes {\n  ageRange\n  availabilityStatus\n  availabilityText\n  canAddToBag\n  canAddToWishlist\n  featuredFlags {\n    key\n    label\n    __typename\n  }\n  isNew\n  isHardToFind\n  isExclusive\n  onSale\n  pieceCount\n  rating\n  vipAvailabilityStatus\n  vipAvailabilityText\n  vipCanAddToBag\n  programPlayType\n  __typename\n}\n\nfragment SKUPriceAttributes on Price {\n  formattedAmount\n  formattedValue\n  currencyCode\n  centAmount\n  __typename\n}\n\nfragment TabbedSKUCarouselData on TabbedContent {\n  id\n  tabbedContentTitle: title\n  titleAlignment\n  accessibleTitle\n  analyticsTitle\n  tabbedContentBackgroundColor: backgroundColor\n  colorMode\n  contentType\n  tabs {\n    __typename\n    ...SKUCarouselData\n  }\n  __typename\n}\n\nfragment RewardListingSectionData on RewardListingSection {\n  __typename\n  id\n  title\n}\n\nfragment RewardCarouselData on RewardCarouselV2 {\n  id\n  title\n  showTitle\n  analyticsTitle\n  backgroundColor\n  textColor\n  nextAriaLabel\n  previousAriaLabel\n  cta {\n    label\n    link\n    __typename\n  }\n  rewards {\n    ... on RewardV4 {\n      id\n      title\n      rewardId\n      description\n      images {\n        id\n        url\n        listingDimensions {\n          width\n          height\n          __typename\n        }\n        __typename\n      }\n      new\n      startDate\n      endDate\n      pointValue\n      restrictedInCountry\n      type\n      quantity\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment Dimensions on Dimensions {\n  width\n  height\n  __typename\n}\n\nfragment DynamicRewardImageAssetDetails on RewardImageAssetDetails {\n  id\n  url\n  listingDimensions {\n    ...Dimensions\n    __typename\n  }\n  __typename\n}\n\nfragment RewardSectionData on RewardSection {\n  __typename\n  id\n  title\n  sectionOpen\n  rewards {\n    id\n    title\n    pointValue\n    rewardId\n    restrictedInCountry\n    type\n    new\n    images {\n      ...DynamicRewardImageAssetDetails\n      __typename\n    }\n    __typename\n  }\n}\n\nfragment AdvancedQuickLinksData on AdvancedQuickLinkWrapper {\n  __typename\n  id\n  title\n  titlePosition\n  analyticsTitle\n  advancedQuickLinksBackgroundColor: backgroundColor\n  titleColor\n  cardLayout\n  quickLinksList {\n    __typename\n    id\n    image\n    label\n    labelColor\n    link\n    labelPositionHorizontal\n    labelPositionVertical\n    analyticsTitle\n    tags {\n      tag\n      terms\n      __typename\n    }\n  }\n  tags {\n    tag\n    terms\n    __typename\n  }\n}\n\nfragment AutoGeneratedAdvancedQuickLinksData on AutoGeneratedAdvancedQuickLinkWrapper {\n  __typename\n  id\n  title\n  titlePosition\n  analyticsTitle\n  advancedQuickLinksBackgroundColor: backgroundColor\n  titleColor\n  cardLayout\n  quickLinksList {\n    ... on AdvancedQuickLink {\n      id\n      image\n      label\n      labelColor\n      link\n      labelPositionHorizontal\n      labelPositionVertical\n      analyticsTitle\n      productSKU\n      tags {\n        tag\n        terms\n        __typename\n      }\n      __typename\n    }\n    ... on AutoGeneratedAdvancedQuickLink {\n      id\n      image\n      label\n      labelColor\n      link\n      labelPositionHorizontal\n      labelPositionVertical\n      analyticsTitle\n      productSKU\n      tags {\n        tag\n        terms\n        __typename\n      }\n      __typename\n    }\n    ... on PersonalisedAdvancedQuickLink {\n      id\n      image\n      label\n      labelColor\n      link\n      labelPositionHorizontal\n      labelPositionVertical\n      analyticsTitle\n      productSKU\n      tags {\n        tag\n        terms\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  tags {\n    tag\n    terms\n    __typename\n  }\n  personalisationMetadata {\n    modelId\n    modelName\n    personalisationId\n    __typename\n  }\n}\n\nfragment SimpleQuickLinksData on SimpleQuickLinkWrapper {\n  __typename\n  id\n  title\n  titlePosition\n  simpleQuickLinksBackgroundColor: backgroundColor\n  titleColor\n  cardLayout\n  quickLinksList {\n    id\n    image\n    label\n    link\n    analyticsTitle\n    tags {\n      tag\n      terms\n      __typename\n    }\n    __typename\n  }\n  tags {\n    tag\n    terms\n    __typename\n  }\n}\n\nfragment TabbedAdvancedQuickLinksData on TabbedContent {\n  id\n  tabbedContentTitle: title\n  titleAlignment\n  accessibleTitle\n  analyticsTitle\n  colorMode\n  tabbedContentBackgroundColor: backgroundColor\n  contentType\n  tabs {\n    __typename\n    ...AdvancedQuickLinksData\n    ...AutoGeneratedAdvancedQuickLinksData\n  }\n  __typename\n}\n\nfragment ContentCardsData on ContentCardWrapper {\n  id\n  title\n  analyticsTitle\n  cta {\n    label\n    link\n    __typename\n  }\n  contentCardWrapperBackgroundColor: backgroundColor\n  textColor\n  titleSize\n  contentAlignment\n  contentCardsLayout: cardLayout\n  showDescription\n  displayType\n  cardsList {\n    ... on ContentCard {\n      __typename\n      id\n      image\n      altText\n      title\n      analyticsTitle\n      description\n      editorialCardBackgroundColor\n      editorialCardTextColor\n      primaryCta {\n        label\n        link\n        __typename\n      }\n      openInNewTab\n      primaryAccountAction\n      primaryReturnUrl\n      primaryLogo {\n        logoName\n        altText\n        __typename\n      }\n      secondaryLogo {\n        logoName\n        altText\n        __typename\n      }\n      tags {\n        tag\n        terms\n        __typename\n      }\n    }\n    __typename\n  }\n  editorialLayout {\n    heroCardPosition\n    standardCardOrientation\n    heroCardContentAlignment\n    __typename\n  }\n  previousAriaLabel\n  nextAriaLabel\n  tags {\n    tag\n    terms\n    __typename\n  }\n  __typename\n}\n\nfragment TabbedContentCardsData on TabbedContent {\n  id\n  tabbedContentTitle: title\n  titleAlignment\n  accessibleTitle\n  analyticsTitle\n  tabbedContentBackgroundColor: backgroundColor\n  colorMode\n  contentType\n  tabs {\n    __typename\n    ...ContentCardsData\n  }\n  __typename\n}\n\nfragment BrickBreakerBannerData on BrickBreakerBanner {\n  id\n  topColor\n  bottomColor\n  bannerStyle\n  __typename\n}\n\nfragment ShoppableGalleryGridData on ShoppableGalleryGrid {\n  id\n  title\n  strapline\n  analyticsTitle\n  shoppableGalleryGridTextAlignment: textAlignment\n  cta {\n    label\n    link\n    __typename\n  }\n  galleryGridCardsList {\n    image\n    username\n    product {\n      name\n      productCode\n      slug\n      ... on SingleVariantProduct {\n        __typename\n        variant {\n          price {\n            formattedAmount\n            formattedValue\n            currencyCode\n            centAmount\n            __typename\n          }\n          __typename\n        }\n      }\n      ... on MultiVariantProduct {\n        __typename\n        variants {\n          price {\n            formattedAmount\n            formattedValue\n            currencyCode\n            centAmount\n            __typename\n          }\n          __typename\n        }\n      }\n      ... on ReadOnlyProduct {\n        __typename\n      }\n      __typename\n    }\n    closedHotSpotLabel\n    openedHotSpotLabel\n    __typename\n  }\n  tags {\n    tag\n    terms\n    __typename\n  }\n  __typename\n}\n\nfragment PromotionCarouselData on PromotionCarousel {\n  id\n  __typename\n  title\n  promotionCarouselStrapline: strapline\n  analyticsTitle\n  promotionCarouselBackgroundColor: backgroundColor\n  textColor\n  nextAriaLabel\n  previousAriaLabel\n  promotionCardsList {\n    title\n    tagline\n    promotionWithProductInfo {\n      products {\n        id\n        name\n        slug\n        primaryImage\n        productCode\n        programCategory {\n          name\n          key\n          __typename\n        }\n        ... on SingleVariantProduct {\n          variant {\n            __typename\n            id\n            sku\n            price {\n              formattedAmount\n              currencyCode\n              __typename\n            }\n            attributes {\n              safetyWarning {\n                key\n                label\n                longMessage\n                showSafetyImage\n                imageKey\n                __typename\n              }\n              maxOrderQuantity\n              availabilityStatus\n              availabilityText\n              vipAvailabilityText\n              vipAvailabilityStatus\n              canAddToBag\n              vipCanAddToBag\n              bisNotificationState\n              programPlayType\n              featuredFlags {\n                key\n                label\n                __typename\n              }\n              __typename\n            }\n          }\n          __typename\n        }\n        __typename\n      }\n      campaignId\n      campaignEndDate\n      campaignStartDate\n      validity\n      discountTagValue\n      discountedPromotionProductPrice\n      promotionType\n      savings {\n        currencyCode\n        centAmount\n        formattedAmount\n        __typename\n      }\n      offerPrice {\n        currencyCode\n        centAmount\n        formattedAmount\n        __typename\n      }\n      originalPrice {\n        currencyCode\n        centAmount\n        formattedAmount\n        __typename\n      }\n      __typename\n    }\n    labels {\n      originalPriceLabel\n      offerPriceLabel\n      savingsLabel\n      validityLabel\n      termsAndConditionsLabel\n      termsAndConditionsLink\n      __typename\n    }\n    __typename\n  }\n  tags {\n    tag\n    terms\n    __typename\n  }\n  backupContent {\n    skuCarousel {\n      ...SKUCarouselData\n      __typename\n    }\n    __typename\n  }\n}\n\nfragment WelcomeBackBannerData on WelcomeBackBanner {\n  id\n  title\n  wbbBackgroundColor: backgroundColor\n  textColor\n  analyticsTitle\n  welcomeTitle\n  welcomeMessage\n  rewardThumbnailImage\n  rewardThumbnailAltText\n  tags {\n    tag\n    terms\n    __typename\n  }\n  __typename\n}\n\nfragment HighlightedProductBannerData on HighlightedProductBanner {\n  id\n  highlightedBannerAnalyticsTitle: analyticsTitle\n  highlightedBannerBackgroundColor: backgroundColor\n  playfulImage {\n    url\n    altText\n    animated\n    __typename\n  }\n  primaryCta {\n    label\n    link\n    accountAction\n    returnUrl\n    appearance\n    textColor\n    __typename\n  }\n  primaryHeading\n  primaryLogo {\n    logoName\n    altText\n    __typename\n  }\n  secondaryCta {\n    label\n    link\n    accountAction\n    returnUrl\n    appearance\n    textColor\n    __typename\n  }\n  strapline\n  subheading\n  textColor\n  cards {\n    altText\n    backgroundColor\n    description\n    heading\n    image\n    linkUrl\n    type\n    textColor\n    ... on HighlightedProductCardManual {\n      id\n      __typename\n    }\n    ... on HighlightedProductCardProduct {\n      id\n      productSku\n      __typename\n    }\n    ... on HighlightedProductCardReward {\n      id\n      label\n      rewardId\n      __typename\n    }\n    __typename\n  }\n  tags {\n    tag\n    terms\n    __typename\n  }\n  __typename\n}\n\nfragment AutogeneratedHighlightedProductBannerData on AutogeneratedHighlightedProductBanner {\n  id\n  highlightedBannerAnalyticsTitle: analyticsTitle\n  highlightedBannerBackgroundColor: backgroundColor\n  layout {\n    width\n    colors {\n      background\n      __typename\n    }\n    __typename\n  }\n  tags {\n    tag\n    terms\n    __typename\n  }\n  textColor\n  primaryLogo {\n    logoName\n    altText\n    __typename\n  }\n  primaryHeading\n  subheading\n  strapline\n  primaryCta {\n    label\n    link\n    accountAction\n    returnUrl\n    appearance\n    textColor\n    __typename\n  }\n  cards {\n    type\n    image\n    altText\n    heading\n    description\n    textColor\n    backgroundColor\n    linkUrl\n    productSku\n    __typename\n  }\n  __typename\n}\n\nfragment UpsellCarouselData on UpsellCarousel {\n  id\n  upsellCarouselHeading: heading\n  upsellCarouselBodyText: bodyText\n  upsellCarouselBackgroundColor: backgroundColor\n  setCountText\n  textColor\n  ariaCloseLabel\n  upsellCarouselAnalyticsTitle: analyticsTitle\n  badge {\n    text\n    textColor\n    upsellCarouselBadgeBackgroundColor: backgroundColor\n    __typename\n  }\n  upsellCarouselCards: cards {\n    id\n    type\n    ... on UpsellProductCard {\n      imageOverrideUrl\n      imageOverrideAltText\n      product {\n        id\n        name\n        productCode\n        pdpPath\n        primaryImage\n        secondaryImage\n        listingAssets(type: IMAGE, limit: 1) {\n          id\n          url\n          tag\n          __typename\n        }\n        ... on SingleVariantProduct {\n          variant {\n            id\n            sku\n            salePercentage\n            attributes {\n              ...ProductVariantAttributes\n              __typename\n            }\n            price {\n              ...ProductPriceAttributes\n              __typename\n            }\n            __typename\n          }\n          __typename\n        }\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment ProductVariantAttributes on ProductAttributes {\n  ageRange\n  availabilityStatus\n  availabilityText\n  canAddToBag\n  canAddToWishlist\n  maxOrderQuantity\n  safetyWarning {\n    imageKey\n    key\n    label\n    longMessage\n    showSafetyImage\n    __typename\n  }\n  vipCanAddToBag\n  programPlayType\n  featuredFlags {\n    key\n    label\n    __typename\n  }\n  __typename\n}\n\nfragment ProductPriceAttributes on Price {\n  formattedAmount\n  formattedValue\n  currencyCode\n  centAmount\n  __typename\n}\n\nfragment ContentContainerData_WithGiftFinderResultsSection on ContentContainer {\n  ...BaseContentContainer\n  section {\n    ...BaseContentSection\n    ... on GiftFinderResultsSection {\n      id\n      layout {\n        width\n        colors {\n          background\n          __typename\n        }\n        removePadding\n        backgroundColor\n        __typename\n      }\n      productResults(\n        giftFinderFilters: $filters\n        giftFinderAnswers: $giftFinderAnswers\n      ) {\n        ...ProductListings\n        isFeaturedProducts\n        __typename\n      }\n      initialResultsCount\n      batchSize\n      loadMoreText\n      disruptors {\n        disruptor {\n          ...DisruptorStatic\n          __typename\n        }\n        index\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment BaseTargetedContainer on TargetedContainer {\n  multivariate {\n    experimentId\n    entityId\n    testingId\n    inExperimentAudience\n    __typename\n  }\n  insiderStatus\n  section {\n    ...BaseContentSection\n    __typename\n  }\n  __typename\n}"

class LegoSpider(scrapy.Spider):
    name = "lego"
    custom_settings = {
        'DOWNLOAD_DELAY':10
    }
    headers = {
        "accept": "*/*",
        "accept-language": "fr-FR,fr;q=0.9,ar-DZ;q=0.8,ar;q=0.7,en-US;q=0.6,en;q=0.5",
        "cache-control": "no-cache",
        "content-type": "application/json",
        "dnt": "1",
        "origin": "https://www.lego.com",
        "pragma": "no-cache",
        "priority": "u=1, i",
        "referer": "https://www.lego.com/en-us/categories/new-sets-and-products?page=2&offset=0",
        "sec-ch-ua": '"Google Chrome";v="129", "Not=A?Brand";v="8", "Chromium";v="129"',
        "sec-ch-ua-mobile": "?0",
        "sec-ch-ua-platform": '"Linux"',
        "sec-fetch-dest": "empty",
        "sec-fetch-mode": "same-origin",
        "sec-fetch-site": "same-origin",
        "user-agent": (
            "Mozilla/5.0 (X11; Linux x86_64) "
            "AppleWebKit/537.36 (KHTML, like Gecko) "
            "Chrome/129.0.0.0 Safari/537.36"
        ),
        "x-locale": "en-US",
        "x-lego-request-id": "8a65b513-0ce6-433d-b0c9-789cb0c9e4c7-app-shop-c-900bfee0",
    }

    def start_requests(self):
        url = "https://www.lego.com/api/graphql/ContentPageQuery"


        body = {
            "operationName": "ContentPageQuery",
            "variables": {
                "sort": {"key": "FEATURED", "direction": "DESC"},
                "filters": [],
                "page": 1,
                "perPage": 18,
                "offset": 0,
                "slug": "/categories/new-sets-and-products",
                "searchSessionId": 1,
            },
            "query": query,
        }

        yield scrapy.Request(
            url=url,
            method="POST",
            headers=self.headers,
            body=json.dumps(body),
            callback=self.parse,
            dont_filter=True,
        )

    def parse(self, response):
        data = response.json()['data']['contentPage']['contentBody']
        products = list(filter(lambda x: x.get('section', {}) and x.get('section', {}).get('__typename', '') == 'BasicProductSection', data))[0]['section']['products']
        for product in products['results']:
            if product.get('variant'):
                item = {
                    'name':product['name'],
                    'images': [image['url'] for image in product['listingImages']],
                    'price':product['variant']['listPrice']['formattedAmount'],
                    'url':f'https://www.lego.com/en-us/product/{product['slug']}'
                }
                url = f"https://www.lego.com/api/graphql/ProductDetails?variables=%7B%22slug%22%3A%22{product['slug']}%22%7D&extensions=%7B%22locale%22%3A%22en-US%22%2C%22persistedQuery%22%3A%7B%22version%22%3A1%2C%22sha256Hash%22%3A%22efaecaa2e0d5ff285b224913358a9173de2856c7206af6d99015ae025ed1982c%22%7D%7D"
                yield scrapy.Request(
                    url=url,
                    headers=self.headers,
                    meta={'item':item},
                    callback=self.parse_pdp
                )
            if product.get('variants'):
                for variant in product['variants']:
                    item = {
                        'name':product['name'],
                        'images': [image['url'] for image in product['listingImages']],
                        'price':variant['listPrice']['formattedAmount'],
                        'url':f'https://www.lego.com/en-us/product/{product['slug']}'
                    }
                    url = f"https://www.lego.com/api/graphql/ProductDetails?variables=%7B%22slug%22%3A%22{product['slug']}%22%7D&extensions=%7B%22locale%22%3A%22en-US%22%2C%22persistedQuery%22%3A%7B%22version%22%3A1%2C%22sha256Hash%22%3A%22efaecaa2e0d5ff285b224913358a9173de2856c7206af6d99015ae025ed1982c%22%7D%7D"
                    yield scrapy.Request(
                        url=url,
                        headers=self.headers,
                        meta={'item':item},
                        dont_filter=True,
                        callback=self.parse_pdp
                    )

        if products['offset'] < products['total']:
            url = "https://www.lego.com/api/graphql/ContentPageQuery"
            print(round((products['offset']/products['perPage']) + 2))
            body = {
                "operationName": "ContentPageQuery",
                "variables": {
                    "sort": {"key": "FEATURED", "direction": "DESC"},
                    "filters": [],
                    "page": round((products['offset']/products['perPage']) + 2),
                    "perPage": 18,
                    "offset": round((products['offset']/products['perPage']) + 2),
                    "slug": "/categories/new-sets-and-products",
                    "searchSessionId": 1,
                },
                "query": query,
            }

            yield scrapy.Request(
                url=url,
                method="POST",
                headers=self.headers,
                body=json.dumps(body),
                callback=self.parse,
            )

    def parse_pdp(self, response):
        item = response.meta['item']
        data = response.json()['data']['product']
        item['description'] = remove_tags(data['description'])
        item['set_id'] = data['productCode']
        item['source'] = 'LEGO'
        item['category'] = data['brandCategory']['name']
        yield item 
        yield scrapy.Request(
            url="https://lego1.up.railway.app/api/ingest-set/",
            method="POST",
            body=json.dumps(item),
            callback=self.check,
            errback=self.errback,
            headers={"Content-Type": "application/json"},
        )

    def errback(self, failure):
        breakpoint()


    def check(self, response):
        pass